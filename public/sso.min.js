// eslint-disable-next-line no-unused-vars
const ssoLogin = async () => {
  try {
    return await (async () =>
      new Promise((e, t) => {
        const o = setTimeout(() => {
          t("Time out!");
        }, 5000);
        window.addEventListener("message", (i) => {
          if (i.origin.indexOf(SSO_HOST) >= 0)
            if ("logout" == i.data) window.location.reload();
            else {
              const s = i.data;
              (s && s.AccessToken) || t("Null credentials!"),
                clearTimeout(o),
                Object.keys(s).forEach((e) => {
                  localStorage[e] = s[e];
                }),
                e(s);
            }
        });

        var i = document.createElement("iframe");
        i.setAttribute("id", "authIframe");
        var s = document.body;
        i.setAttribute(
          "style",
          "width:0;height:0;border:0;border:none;position:absolute;"
        ),
          i.setAttribute("src", SSO_HOST + "/iframe-sso.html"),
          console.log("i-frame", i);
        s.appendChild(i);
      }))();
  } catch (e) {
    localStorage.clear();
    const t = SSO_HOST + `/login?redirect=${window.location.href}`;
    window.location.replace(t);
  }
};
// eslint-disable-next-line no-unused-vars
window.ssoLogout = () => {
  localStorage.clear();
  const e = SSO_HOST + `/login?redirect=${window.location.href}`;
  window.location.replace(e);
};
